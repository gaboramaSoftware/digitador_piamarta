<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
    <title>Panel de Administraci√≥n - Digitador Piamarta</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>

<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="logo">
                <h2>Digitador</h2>
                <span>Admin Panel</span>
            </div>
            <nav>
                <a href="#" class="active" onclick="showSection('dashboard')">
                    <span class="icon">üìä</span> Dashboard
                </a>
                <a href="#" onclick="showSection('students')">
                    <span class="icon">üë•</span> Estudiantes
                </a>
                <a href="#" onclick="showSection('settings')">
                    <span class="icon">‚öôÔ∏è</span> Configuraci√≥n
                </a>
            </nav>
            <div class="status-box">
                <div class="status-indicator online"></div>
                <span>Sistema Online</span>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header>
                <div class="header-title">
                    <h1 id="page-title">Dashboard</h1>
                    <span class="date-display" id="current-date">Cargando fecha...</span>
                </div>
                <div class="header-actions">
                    <button class="btn-refresh" onclick="refreshData()">
                        <span class="icon">üîÑ</span> Actualizar
                    </button>
                    <div class="user-profile">
                        <span>Admin</span>
                        <div class="avatar">A</div>
                    </div>
                </div>
            </header>

            <!-- Dashboard Section -->
            <div id="dashboard" class="section active">
                <!-- Stats Cards -->
                <div class="stats-grid">
                    <div class="card stat-card">
                        <div class="stat-icon breakfast">‚òï</div>
                        <div class="stat-info">
                            <h3>Desayunos</h3>
                            <p class="stat-value" id="count-breakfast">0</p>
                            <span class="stat-label">Hoy</span>
                        </div>
                    </div>
                    <div class="card stat-card">
                        <div class="stat-icon lunch">üçΩÔ∏è</div>
                        <div class="stat-info">
                            <h3>Almuerzos</h3>
                            <p class="stat-value" id="count-lunch">0</p>
                            <span class="stat-label">Hoy</span>
                        </div>
                    </div>
                    <div class="card stat-card">
                        <div class="stat-icon total">üìù</div>
                        <div class="stat-info">
                            <h3>Total Raciones</h3>
                            <p class="stat-value" id="count-total">0</p>
                            <span class="stat-label">Hoy</span>
                        </div>
                    </div>
                    <div class="card stat-card">
                        <div class="stat-icon terminal">üñ•Ô∏è</div>
                        <div class="stat-info">
                            <h3>Terminales</h3>
                            <p class="stat-value">1</p>
                            <span class="stat-label">Activos</span>
                        </div>
                    </div>
                </div>

                <!-- Recent Activity Table -->
                <div class="card table-card">
                    <div class="card-header">
                        <h3>Registros Recientes</h3>
                        <div class="card-actions">
                            <div class="exportar">
                                <button class="btn-exportar" onclick="exportToExcel()">Exportar a Excel</button>
                            </div>
                            <div class="search-box">
                                <input type="text" id="search-input" placeholder="Buscar por nombre o RUN..."
                                    onkeyup="filterTable()">
                            </div>
                        </div>
                    </div>
                    <div class="table-responsive">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Estudiante</th>
                                    <th>Curso</th>
                                    <th>Raci√≥n</th>
                                    <th>Hora</th>
                                    <th>Terminal</th>
                                    <th>Estado</th>
                                </tr>
                            </thead>
                            <tbody id="records-body">
                                <tr>
                                    <td colspan="7" class="text-center">Cargando datos...</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Students Section -->
            <div id="students" class="section">
                <!-- Actions Bar -->
                <div class="students-actions-bar">
                    <button class="btn-primary" onclick="openEnrollModal()">
                        <span class="icon">‚ûï</span> Enrolar Estudiante
                    </button>
                </div>

                <!-- Students Table -->
                <div class="card table-card">
                    <div class="card-header">
                        <h3>Gesti√≥n de Estudiantes</h3>
                        <div class="card-header-filters">
                            <div class="filter-group">
                                <select id="course-filter" onchange="filterStudentsByCourse()">
                                    <option value="">Todos los cursos</option>
                                    <option value="1¬∞ B√°sico">1¬∞ B√°sico</option>
                                    <option value="2¬∞ B√°sico">2¬∞ B√°sico</option>
                                    <option value="3¬∞ B√°sico">3¬∞ B√°sico</option>
                                    <option value="4¬∞ B√°sico">4¬∞ B√°sico</option>
                                    <option value="5¬∞ B√°sico">5¬∞ B√°sico</option>
                                    <option value="6¬∞ B√°sico">6¬∞ B√°sico</option>
                                    <option value="7¬∞ B√°sico">7¬∞ B√°sico</option>
                                    <option value="8¬∞ B√°sico">8¬∞ B√°sico</option>
                                    <option value="1¬∞ Medio">1¬∞ Medio</option>
                                    <option value="2¬∞ Medio">2¬∞ Medio</option>
                                    <option value="3¬∞ Medio">3¬∞ Medio</option>
                                    <option value="4¬∞ Medio">4¬∞ Medio</option>
                                </select>
                            </div>   
                            <div class="search-box">
                                <input type="text" id="search-students-input" placeholder="Buscar por nombre o RUN..."
                                    onkeyup="filterStudentsTable()">
                            </div>
                        </div>                                         
                    </div>
                    <div class="table-responsive">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>RUN</th>
                                    <th>Nombre Completo</th>
                                    <th>Curso</th>
                                    <th>Acciones</th>
                                </tr>
                            </thead>
                            <tbody id="students-body">
                                <tr>
                                    <td colspan="5" class="text-center">Cargando datos de estudiantes...</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Reports Section -->
            <div id="reports" class="section">
                <!-- Recent Activity Table -->
                <div class="card table-card">
                    <div class="card-header">
                        <h3>Registros Recientes</h3>
                        <div class="card-actions">
                            <div class="exportar">
                                <button class="btn-exportar" onclick="exportToExcel()">Exportar a Excel</button>
                            </div>
                            <div class="search-box">
                                <input type="text" id="search-input" placeholder="Buscar por nombre o RUN..."
                                       onkeyup="filterTable()">
                            </div>
                        </div>
                    </div>
                    <div class="table-responsive">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Estudiante</th>
                                    <th>Curso</th>
                                    <th>Raci√≥n</th>
                                    <th>Hora</th>
                                    <th>Terminal</th>
                                    <th>Estado</th>
                                </tr>
                            </thead>
                            <tbody id="records-body">
                                <tr>
                                    <td colspan="7" class="text-center">Cargando datos...</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            </div>

            <!-- Settings Section -->
            <div id="settings" class="section">
                <div class="card">
                    <h2>Configuraci√≥n</h2>
                    <p>Pr√≥ximamente...</p>
                </div>
            </div>
        </main>
    </div>

    <!-- Modal: Enrolar Estudiante -->
    <div id="enrollModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Enrolar Nuevo Estudiante</h2>
                <button class="modal-close" onclick="closeEnrollModal()">‚úï</button>
            </div>
            <div class="modal-body">
                <form id="enrollForm" onsubmit="handleEnrollStudent(event)">
                    <div class="form-group">
                        <label for="enroll-run">RUN (sin puntos ni gui√≥n)</label>
                        <input type="text" id="enroll-run" required pattern="[0-9]{7,8}[0-9Kk]"
                            placeholder="Ej: 12345678K" maxlength="9">
                    </div>
                    <div class="form-group">
                        <label for="enroll-nombre">Nombre</label>
                        <input type="text" id="enroll-nombre" required placeholder="Nombre del estudiante">
                    </div>
                    <div class="form-group">
                        <label for="enroll-apellido">Apellido</label>
                        <input type="text" id="enroll-apellido" required placeholder="Apellido del estudiante">
                    </div>
                    <div class="form-group">
                        <label for="enroll-curso">Curso</label>
                        <select id="enroll-curso" required>
                            <option value="">Seleccione un curso</option>
                            <option value="1¬∞ B√°sico">1¬∞ B√°sico</option>
                            <option value="2¬∞ B√°sico">2¬∞ B√°sico</option>
                            <option value="3¬∞ B√°sico">3¬∞ B√°sico</option>
                            <option value="4¬∞ B√°sico">4¬∞ B√°sico</option>
                            <option value="5¬∞ B√°sico">5¬∞ B√°sico</option>
                            <option value="6¬∞ B√°sico">6¬∞ B√°sico</option>
                            <option value="7¬∞ B√°sico">7¬∞ B√°sico</option>
                            <option value="8¬∞ B√°sico">8¬∞ B√°sico</option>
                            <option value="1¬∞ Medio">1¬∞ Medio</option>
                            <option value="2¬∞ Medio">2¬∞ Medio</option>
                            <option value="3¬∞ Medio">3¬∞ Medio</option>
                            <option value="4¬∞ Medio">4¬∞ Medio</option>
                        </select>
                    </div>
                    <div class="modal-actions">
                        <button type="button" class="btn-secondary" onclick="closeEnrollModal()">Cancelar</button>
                        <button type="submit" class="btn-primary">Enrolar Estudiante</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Modal: Estad√≠sticas del Estudiante -->
    <div id="statsModal" class="modal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h2>Estad√≠sticas del Estudiante</h2>
                <button class="modal-close" onclick="closeStatsModal()">‚úï</button>
            </div>
            <div class="modal-body">
                <div class="student-info-header">
                    <div class="student-avatar-large">
                        <span id="stats-avatar-letter">A</span>
                    </div>
                    <div class="student-info-details">
                        <h3 id="stats-student-name">Nombre del Estudiante</h3>
                        <p id="stats-student-run">RUN: 12345678-9</p>
                        <p id="stats-student-curso">Curso: 1¬∞ B√°sico</p>
                    </div>
                    <button class="btn-exportar" onclick="openDetalleModal()">
                        <span class="icon">üìä</span> Detalle Estudiante
                    </button>
                    <button class="btn-exportar" onclick="openEditModal()">
                        <span class="icon">‚úèÔ∏è</span> Editar Informaci√≥n
                    </button>   
                </div>

                <div class="stats-summary">
                    <div class="stat-box">
                        <div class="stat-box-icon breakfast">‚òï</div>
                        <div class="stat-box-info">
                            <p class="stat-box-value" id="stats-breakfast">0</p>
                            <p class="stat-box-label">Desayunos</p>
                        </div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-box-icon lunch">üçΩÔ∏è</div>
                        <div class="stat-box-info">
                            <p class="stat-box-value" id="stats-lunch">0</p>
                            <p class="stat-box-label">Almuerzos</p>
                        </div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-box-icon total">üìä</div>
                        <div class="stat-box-info">
                            <p class="stat-box-value" id="stats-total">0</p>
                            <p class="stat-box-label">Total Raciones</p>
                        </div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-box-icon percentage">üìà</div>
                        <div class="stat-box-info">
                            <p class="stat-box-value" id="stats-percentage">0%</p>
                            <p class="stat-box-label">Asistencia Mensual</p>
                        </div>
                    </div>
                </div>                
            </div>
        </div>
    </div>

    <!--MODAL DE REPORTES-->
    <div id="detalleModal" class="modal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h2>Historial de Alimentaci√≥n</h2>
                <button class="modal-close" onclick="closeDetalleModal()">‚úï</button>
            </div>
            <div class="modal-body">
                <div class="student-info-header" style="margin-bottom: 20px;">
                    <div class="student-info-details">
                        <h3 id="detalle-student-name">Nombre Estudiante</h3>
                        <p id="detalle-student-run">RUN: ...</p>
                    </div>
                    <button class="btn-secondary" onclick="closeDetalleModal(); openStudentStats(currentStudent.run)">
                        ‚¨Ö Volver al Resumen
                    </button>
                </div>

                <div class="table-responsive">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Fecha</th>
                                <th>Hora</th>
                                <th>Tipo Raci√≥n</th>
                                <th>Estado</th>
                            </tr>
                        </thead>
                        <tbody id="detalle-body">
                            <tr>
                                <td colspan="4" class="text-center">Cargando historial...</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!--Modal para editar informacion-->
    <div id="editarModal" class="modal">
    <div class="modal-content modal-small">
        <div class="modal-header">
            <h2>Editar Datos de Usuario</h2>
            <button class="modal-close" onclick="closeEditModal()">‚úï</button>
        </div>
        
        <div class="modal-body">
            <form id="editForm" onsubmit="handleEditStudent(event)">
                
                <div class="form-group">
                    <label for="edit-run">RUN</label>
                    <input type="text" id="edit-run" disabled 
                           style="background-color: #f3f4f6; cursor: not-allowed;">
                </div>

                <div class="form-group">
                    <label for="edit-nombre">Nombre</label>
                    <input type="text" id="edit-nombre" required placeholder="Primer nombre">
                </div>

                <div class="form-group">
                    <label for="edit-apellido">Apellidos</label>
                    <input type="text" id="edit-apellido" required placeholder="Apellidos">
                </div>

                <div class="modal-actions">
                    <button type="button" class="btn-secondary" onclick="closeEditModal()">Cancelar</button>
                    <button type="submit" class="btn-primary" onclick="closeEditModal()">Guardar Cambios</button>
                </div>
            </form>
            <button type="button" class="btn-danger" onclick="openDeleteModal()">
                <span class="icon">üóëÔ∏è</span> Eliminar Estudiante
            </button>
        </div>
    </div>
</div>

    <!-- Modal: Confirmaci√≥n de Eliminaci√≥n -->
    <div id="deleteModal" class="modal">
        <div class="modal-content modal-small">
            <div class="modal-header">
                <h2>‚ö†Ô∏è Confirmar Eliminaci√≥n</h2>
                <button class="modal-close" onclick="closeDeleteModal()">‚úï</button>
            </div>
            <div class="modal-body">
                <p>¬øEst√° seguro que desea eliminar a <strong id="delete-student-name"></strong>?</p>
                <p class="warning-text">Esta acci√≥n no se puede deshacer.</p>
                <div class="modal-actions">
                    <button type="button" class="btn-secondary" onclick="closeDeleteModal()">Cancelar</button>
                    <button type="button" class="btn-danger" onclick="handleDeleteStudent()">Eliminar</button>
                </div>
            </div>
        </div>
    </div>
    <script src="chart.main.js"></script>
    <script src="app.js"></script>
</body>

</html>